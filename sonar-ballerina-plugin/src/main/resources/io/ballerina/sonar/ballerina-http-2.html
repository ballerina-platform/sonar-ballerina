<p>
    Having a permissive Cross-Origin Resource Sharing policy is security-sensitive, and it has led in the past to the following vulnerabilities.
</p>
<ul>
    <li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a></li>
    <li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a></li>
</ul>
<p>
    Browsers enforce the same-origin policy by default, as a security measure, preventing JavaScript frontends from
    making cross-origin HTTP requests to resources with different origins (domains, protocols, or ports).
    However, the target resource can include additional HTTP headers in its response, known as CORS headers,
    which serve as directives for the browser and modify the access control policy, effectively relaxing the same-origin policy.
</p>

<h2>Noncompliant Code Example</h2>

<pre>
listener http:Listener endpoint = new (8080);

service / on endpoint {
    @http:ResourceConfig {
        cors: {
            allowOrigins: ["*"] // Sensitive
        }
    }

    resource function get example() returns http:Response|error? {
        // Return response
    }
}

</pre>

<h2>Compliant Solution</h2>

<p>
    The resource configuration should be configured exclusively for trusted origins  and specific resources.
</p>

<pre>
listener http:Listener endpoint = new (8080);

service / on endpoint {
    @http:ResourceConfig {
        cors: {
            allowOrigins: ["trustedwebsite.com"] // Compliant
        }
    }

    resource function get example() returns http:Response|error? {
        // Return response
    }
}
</pre>
