<p>
    Arguments of system commands are processed by the executed program.
    The arguments are usually used to configure and influence the behavior of the programs.
    Control over a single argument might be enough for an attacker to trigger dangerous features like
    executing arbitrary commands or writing files into specific directories.
</p>

<p>
    Arguments like -delete or -exec for the find command can alter the expected behavior and result in vulnerabilities.
</p>

<h2>Noncompliant Code Example</h2>

<pre>
string terminalPath = ...;
string input = request.getQueryParamValue("input").toString();
string[] cmd = [..., input];

// Sensitive
os:Process result = check os:exec({
    value: terminalPath,
    arguments: cmd
});
</pre>

<h2>Compliant Solution</h2>

<p>
    Use an allow-list to restrict the arguments to trusted values.
</p>

<pre>
string terminalPath = ...;
string input = request.getQueryParamValue("input").toString();
string[] cmd = [..., input];
string[] allowed = ["main", "main.bal", "bal"];

if allowed.some(keyword => keyword.equalsIgnoreCaseAscii(input)) {
    os:Process result = check os:exec({
        value: terminalPath,
        arguments: cmd
    });
}
</pre>
